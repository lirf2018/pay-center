2020-01-12 12:50:43 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 12:54:31 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 12:55:21 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 12:56:55 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 12:57:49 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 12:58:52 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 13:01:22 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 13:03:11 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 13:05:35 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 13:07:18 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 13:10:58 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 14:37:44 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 14:39:05 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 14:52:39 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 15:03:46 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 15:12:53 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 15:26:52 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 15:26:54 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db2 db built
2020-01-12 15:28:08 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 15:28:11 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db2 db built
2020-01-12 15:38:31 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 15:38:34 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db2 db built
2020-01-12 15:49:32 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 15:49:34 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db2 db built
2020-01-12 15:51:12 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 15:51:15 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db2 db built
2020-01-12 15:52:50 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db1 db built
2020-01-12 15:52:53 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - db2 db built
2020-01-12 15:59:13 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 15:59:16 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 16:00:42 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 16:00:44 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 16:14:35 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 16:14:38 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 16:16:28 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 16:16:30 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 16:16:31 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 16:16:31 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 16:18:33 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 16:18:35 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 16:18:36 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 16:18:36 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 16:20:09 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 16:20:11 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 16:20:12 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 16:20:12 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 16:53:36 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 16:53:39 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 16:53:40 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 16:53:40 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 16:54:24 [http-nio-8087-exec-4] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"1578819264608","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819264"}
2020-01-12 16:54:24 [http-nio-8087-exec-4] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 16:54:24 [http-nio-8087-exec-4] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"1578819264608","sign":"1dfcdb445c75e39f689f1c550c93e9ea","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819264"}
2020-01-12 16:54:24 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjE1Nzg4MTkyNjQ2MDgiLCJzaWduIjoiMWRmY2RiNDQ1Yzc1ZTM5ZjY4OWYxYzU1MGM5M2U5ZWEiLCJidXNpbmVzc19jb2RlIjoib3JkZXJfcGF5IiwicGF5X3dheSI6MiwicmVjb3JkX3R5cGUiOjQsImNsaWVudF9jb2RlIjoiaDUtd2ViIiwidGltZXN0YW1wIjoiMTU3ODgxOTI2NCJ9
2020-01-12 16:54:24 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"1578819264608","sign":"1dfcdb445c75e39f689f1c550c93e9ea","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819264"}
2020-01-12 16:54:24 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - -----clientJson为空-----
2020-01-12 16:55:21 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"1578819321633","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819321"}
2020-01-12 16:55:21 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 16:55:21 [http-nio-8087-exec-1] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"1578819321633","sign":"d206349f7e0bf8849b9bc0d0f9fa4f32","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819321"}
2020-01-12 16:55:21 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjE1Nzg4MTkzMjE2MzMiLCJzaWduIjoiZDIwNjM0OWY3ZTBiZjg4NDliOWJjMGQwZjlmYTRmMzIiLCJidXNpbmVzc19jb2RlIjoib3JkZXJfcGF5IiwicGF5X3dheSI6MiwicmVjb3JkX3R5cGUiOjQsImNsaWVudF9jb2RlIjoiaDUtd2ViIiwidGltZXN0YW1wIjoiMTU3ODgxOTMyMSJ9
2020-01-12 16:55:21 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"1578819321633","sign":"d206349f7e0bf8849b9bc0d0f9fa4f32","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819321"}
2020-01-12 16:55:45 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----clientJson为空-----
2020-01-12 16:56:42 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 16:57:16 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 16:57:19 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 16:57:19 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 16:57:19 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 16:59:22 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"1578819562435","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819562"}
2020-01-12 16:59:22 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 16:59:22 [http-nio-8087-exec-3] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"1578819562435","sign":"b67f432dd3469ef8895746d7aa081d39","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819562"}
2020-01-12 16:59:22 [http-nio-8087-exec-7] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjE1Nzg4MTk1NjI0MzUiLCJzaWduIjoiYjY3ZjQzMmRkMzQ2OWVmODg5NTc0NmQ3YWEwODFkMzkiLCJidXNpbmVzc19jb2RlIjoib3JkZXJfcGF5IiwicGF5X3dheSI6MiwicmVjb3JkX3R5cGUiOjQsImNsaWVudF9jb2RlIjoiaDUtd2ViIiwidGltZXN0YW1wIjoiMTU3ODgxOTU2MiJ9
2020-01-12 16:59:22 [http-nio-8087-exec-7] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"1578819562435","sign":"b67f432dd3469ef8895746d7aa081d39","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819562"}
2020-01-12 16:59:22 [http-nio-8087-exec-7] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"1578819562435","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578819562"}
2020-01-12 16:59:22 [http-nio-8087-exec-7] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 16:59:22 [http-nio-8087-exec-7] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:b67f432dd3469ef8895746d7aa081d39
2020-01-12 16:59:22 [http-nio-8087-exec-7] INFO  [com.yufan.controller.PayController] - -------待付款订单不存在------
2020-01-12 17:00:46 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:00:49 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:00:49 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:00:49 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:01:34 [http-nio-8087-exec-6] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"1578819694882","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819694"}
2020-01-12 17:01:34 [http-nio-8087-exec-6] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:01:34 [http-nio-8087-exec-6] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"1578819694882","sign":"0f3ffa4d3314b17579ab401d3102b9fb","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819694"}
2020-01-12 17:01:34 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjE1Nzg4MTk2OTQ4ODIiLCJzaWduIjoiMGYzZmZhNGQzMzE0YjE3NTc5YWI0MDFkMzEwMmI5ZmIiLCJidXNpbmVzc19jb2RlIjoib3JkZXJfcGF5IiwicGF5X3dheSI6MiwicmVjb3JkX3R5cGUiOjQsImNsaWVudF9jb2RlIjoiaDUtd2ViIiwidGltZXN0YW1wIjoiMTU3ODgxOTY5NCJ9
2020-01-12 17:01:34 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"1578819694882","sign":"0f3ffa4d3314b17579ab401d3102b9fb","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578819694"}
2020-01-12 17:01:35 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"1578819694882","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578819694"}
2020-01-12 17:01:35 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:01:35 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:0f3ffa4d3314b17579ab401d3102b9fb
2020-01-12 17:03:58 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:04:00 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:06:37 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:06:40 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:06:41 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:06:41 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:07:02 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"1578820022391","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820022"}
2020-01-12 17:07:02 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:07:02 [http-nio-8087-exec-5] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"1578820022391","sign":"f3492a038b357e37fdd398ab20b51450","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820022"}
2020-01-12 17:07:02 [http-nio-8087-exec-7] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjE1Nzg4MjAwMjIzOTEiLCJzaWduIjoiZjM0OTJhMDM4YjM1N2UzN2ZkZDM5OGFiMjBiNTE0NTAiLCJidXNpbmVzc19jb2RlIjoib3JkZXJfcGF5IiwicGF5X3dheSI6MiwicmVjb3JkX3R5cGUiOjQsImNsaWVudF9jb2RlIjoiaDUtd2ViIiwidGltZXN0YW1wIjoiMTU3ODgyMDAyMiJ9
2020-01-12 17:07:02 [http-nio-8087-exec-7] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"1578820022391","sign":"f3492a038b357e37fdd398ab20b51450","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820022"}
2020-01-12 17:07:02 [http-nio-8087-exec-7] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"1578820022391","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578820022"}
2020-01-12 17:07:02 [http-nio-8087-exec-7] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:07:02 [http-nio-8087-exec-7] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:f3492a038b357e37fdd398ab20b51450
2020-01-12 17:07:02 [http-nio-8087-exec-7] INFO  [com.yufan.controller.PayController] - -------待付款订单不存在------
2020-01-12 17:09:32 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:09:36 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:09:37 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:09:37 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:12:29 [http-nio-8087-exec-10] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820349"}
2020-01-12 17:12:29 [http-nio-8087-exec-10] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:12:29 [http-nio-8087-exec-10] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"1c169524cc05df51b3fbed8390791bcb","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820349"}
2020-01-12 17:12:29 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjFjMTY5NTI0Y2MwNWRmNTFiM2ZiZWQ4MzkwNzkxYmNiIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjAzNDkifQ==
2020-01-12 17:12:29 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"1c169524cc05df51b3fbed8390791bcb","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820349"}
2020-01-12 17:12:29 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578820349"}
2020-01-12 17:12:29 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:12:29 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:1c169524cc05df51b3fbed8390791bcb
2020-01-12 17:12:29 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -------订单orderPrice不能为0------orderPrice: 0
2020-01-12 17:13:39 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:13:41 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:13:42 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:13:42 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:13:55 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820434"}
2020-01-12 17:13:55 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:13:55 [http-nio-8087-exec-1] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"4ea8b105e49e1609df3ec544b261f0a7","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820434"}
2020-01-12 17:13:55 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjRlYThiMTA1ZTQ5ZTE2MDlkZjNlYzU0NGIyNjFmMGE3IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjA0MzQifQ==
2020-01-12 17:13:55 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"4ea8b105e49e1609df3ec544b261f0a7","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820434"}
2020-01-12 17:13:55 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578820434"}
2020-01-12 17:13:55 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:13:55 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:4ea8b105e49e1609df3ec544b261f0a7
2020-01-12 17:13:55 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - -------订单orderPrice不能为0------orderPrice: 0
2020-01-12 17:15:48 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:15:50 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:15:51 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:15:51 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:17:29 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820649"}
2020-01-12 17:17:29 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:17:29 [http-nio-8087-exec-1] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"982a49496b1dc0fa7a4b745c93a425b3","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820649"}
2020-01-12 17:17:30 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6Ijk4MmE0OTQ5NmIxZGMwZmE3YTRiNzQ1YzkzYTQyNWIzIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjA2NDkifQ==
2020-01-12 17:17:30 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"982a49496b1dc0fa7a4b745c93a425b3","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820649"}
2020-01-12 17:17:30 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578820649"}
2020-01-12 17:17:30 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:17:30 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:982a49496b1dc0fa7a4b745c93a425b3
2020-01-12 17:17:30 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:17:30 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:17:30 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:17:30 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112171730098120
2020-01-12 17:19:24 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820764"}
2020-01-12 17:19:24 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:19:24 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"97159e3080ffc77f07bd91bdf8cd365e","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820764"}
2020-01-12 17:19:24 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6Ijk3MTU5ZTMwODBmZmM3N2YwN2JkOTFiZGY4Y2QzNjVlIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjA3NjQifQ==
2020-01-12 17:19:24 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"97159e3080ffc77f07bd91bdf8cd365e","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820764"}
2020-01-12 17:19:24 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578820764"}
2020-01-12 17:19:24 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:19:24 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:97159e3080ffc77f07bd91bdf8cd365e
2020-01-12 17:19:24 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:19:24 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:19:24 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:19:24 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112171924441795
2020-01-12 17:20:44 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:20:46 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:20:47 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:20:47 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:21:19 [http-nio-8087-exec-7] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820879"}
2020-01-12 17:21:19 [http-nio-8087-exec-7] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:21:19 [http-nio-8087-exec-7] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"e702b8125983147cb058d9ba3bb08388","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820879"}
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6ImU3MDJiODEyNTk4MzE0N2NiMDU4ZDliYTNiYjA4Mzg4IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjA4NzkifQ==
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"e702b8125983147cb058d9ba3bb08388","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820879"}
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578820879"}
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:e702b8125983147cb058d9ba3bb08388
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112172119437160
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112172119437160","order_price":15.00}
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=I7p9vJHr5d%2BnTcnBPVRo10PbaNtmVsX6yEQVxkEj8kYc64WZ1V7lDrmbJuTd4fH3GzQMeAzxJBHX6Pdqj6wZgKuXJCDOPPCBKoZlGZufB9MwV2%2F1MjtnrF2tZxpelrUT46e%2Fl%2Boco6mhLroE0%2FhUc0ExDupKXo3oAt50CULELOG8XkZvG8vHy%2Bzg2d9wYq0jLZ9TqmUYDRRjayCOaVCHbvGeq6x5IcFs8P%2BAcJlAnIUZDvf%2BiIejRaYJTCgCXWecSFvGMm0tKBL%2BEOFW3Hqh3yQsTpdOn%2B%2FJ0aHbjxbRx%2Fl%2Fqsocm7vcnfVCaqgLHWSKgjJy2CFA0rZvoFLuI2uA6Q%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A21%3A19&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172119437160&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 17:21:19 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=I7p9vJHr5d%2BnTcnBPVRo10PbaNtmVsX6yEQVxkEj8kYc64WZ1V7lDrmbJuTd4fH3GzQMeAzxJBHX6Pdqj6wZgKuXJCDOPPCBKoZlGZufB9MwV2%2F1MjtnrF2tZxpelrUT46e%2Fl%2Boco6mhLroE0%2FhUc0ExDupKXo3oAt50CULELOG8XkZvG8vHy%2Bzg2d9wYq0jLZ9TqmUYDRRjayCOaVCHbvGeq6x5IcFs8P%2BAcJlAnIUZDvf%2BiIejRaYJTCgCXWecSFvGMm0tKBL%2BEOFW3Hqh3yQsTpdOn%2B%2FJ0aHbjxbRx%2Fl%2Fqsocm7vcnfVCaqgLHWSKgjJy2CFA0rZvoFLuI2uA6Q%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A21%3A19&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172119437160&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 17:22:47 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:22:49 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:22:50 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:22:50 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:22:59 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820979"}
2020-01-12 17:22:59 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:22:59 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"5cf0102b5259ebdca9283c8f5b46f2ab","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820979"}
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjVjZjAxMDJiNTI1OWViZGNhOTI4M2M4ZjViNDZmMmFiIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjA5NzkifQ==
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"5cf0102b5259ebdca9283c8f5b46f2ab","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578820979"}
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578820979"}
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:5cf0102b5259ebdca9283c8f5b46f2ab
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112172259345349
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112172259345349","order_price":15.00}
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=fOOWLooZ1ol%2BgWUZ%2BQJj0XHYt424BVsrB%2BHuL1RvAMhURiFhXpy8zOH8s1a99%2Fo2ZVWWx4rKcHd7VZthcskF6cBOkI8huElwNFI4vOJpvpGFNw7MECbM6Q2T3YtIR4M3Urw0H0uUtkCPsqU8lq7mfmzKyZCPz9z%2FwBD5YvDUVO51mrWiuwxQ4xXCA3BCkBZWEzxBl63NtB2223XaUSySFayd87sKc%2BD5w8zcdeLljnvQERI3yGNmEZP6bMHRUGoeDX98BQQoI0tfapFzUUQT%2B2hoei%2Fo7j0c68UbjBrvDOlgRUv%2FrtoqxkAXrxgggnBeelfGcEAoGB4zf5fQ1sM34A%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A22%3A59&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172259345349&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 17:22:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=fOOWLooZ1ol%2BgWUZ%2BQJj0XHYt424BVsrB%2BHuL1RvAMhURiFhXpy8zOH8s1a99%2Fo2ZVWWx4rKcHd7VZthcskF6cBOkI8huElwNFI4vOJpvpGFNw7MECbM6Q2T3YtIR4M3Urw0H0uUtkCPsqU8lq7mfmzKyZCPz9z%2FwBD5YvDUVO51mrWiuwxQ4xXCA3BCkBZWEzxBl63NtB2223XaUSySFayd87sKc%2BD5w8zcdeLljnvQERI3yGNmEZP6bMHRUGoeDX98BQQoI0tfapFzUUQT%2B2hoei%2Fo7j0c68UbjBrvDOlgRUv%2FrtoqxkAXrxgggnBeelfGcEAoGB4zf5fQ1sM34A%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A22%3A59&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172259345349&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 17:22:59 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - -----
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$12c18d1a.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$13764e34.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 17:23:32 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:23:32 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:23:33 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:23:33 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:23:39 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821019"}
2020-01-12 17:23:39 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:23:39 [http-nio-8087-exec-1] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"2709e9f377f63907d924bb3303921103","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821019"}
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjI3MDllOWYzNzdmNjM5MDdkOTI0YmIzMzAzOTIxMTAzIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjEwMTkifQ==
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"2709e9f377f63907d924bb3303921103","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821019"}
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578821019"}
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:2709e9f377f63907d924bb3303921103
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112172339172696
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112172339172696","order_price":15.00}
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=aqQrinL18OaWSL5%2Bt0XM1%2FczFEacG79LiP%2B9ADF8%2BdrOEE1OCWJFQyFRGt9ZPCUmOHhgVrGMYTPGvZkEz0dSixnUqQo0TJs68zs41yU0M%2B%2FT%2Bnrsg74EwR9QiXEUukFV6yRPyNN%2B07SqH0QxRr7BRkbgK0GVT%2B2I5PZGxe3V9GZGUnLG8%2B8lJOmhfhQX9a2CQDECWIQJJMhy46U7d1v44DQZ1cO36d0KFEd83QXZCmxTigpLH3PJk1%2BbjmZwH1bqZ8kCOCm8iGiAnTnIs%2FF4tHcNIEdavBJ99QH1zNpYldt5IR8c9rz24ZYFhLoTrN%2FkTEiUKM8QsEaEmEDjHxWItg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A23%3A39&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172339172696&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 17:23:39 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=aqQrinL18OaWSL5%2Bt0XM1%2FczFEacG79LiP%2B9ADF8%2BdrOEE1OCWJFQyFRGt9ZPCUmOHhgVrGMYTPGvZkEz0dSixnUqQo0TJs68zs41yU0M%2B%2FT%2Bnrsg74EwR9QiXEUukFV6yRPyNN%2B07SqH0QxRr7BRkbgK0GVT%2B2I5PZGxe3V9GZGUnLG8%2B8lJOmhfhQX9a2CQDECWIQJJMhy46U7d1v44DQZ1cO36d0KFEd83QXZCmxTigpLH3PJk1%2BbjmZwH1bqZ8kCOCm8iGiAnTnIs%2FF4tHcNIEdavBJ99QH1zNpYldt5IR8c9rz24ZYFhLoTrN%2FkTEiUKM8QsEaEmEDjHxWItg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A23%3A39&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172339172696&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 17:23:39 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$12c18d1a.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$13764e34.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 17:24:39 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:24:41 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:24:42 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:24:42 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:26:03 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821163"}
2020-01-12 17:26:03 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:26:03 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"60948f1abfb72af830f46fc79d66d0b0","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821163"}
2020-01-12 17:26:03 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjYwOTQ4ZjFhYmZiNzJhZjgzMGY0NmZjNzlkNjZkMGIwIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjExNjMifQ==
2020-01-12 17:26:03 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"60948f1abfb72af830f46fc79d66d0b0","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821163"}
2020-01-12 17:26:03 [http-nio-8087-exec-4] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578821163"}
2020-01-12 17:26:03 [http-nio-8087-exec-4] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:26:03 [http-nio-8087-exec-4] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:60948f1abfb72af830f46fc79d66d0b0
2020-01-12 17:26:04 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:26:04 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:26:04 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:26:04 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112172603758759
2020-01-12 17:26:04 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 17:26:04 [http-nio-8087-exec-4] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112172603758759","order_price":15.00}
2020-01-12 17:26:04 [http-nio-8087-exec-4] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=hK0ytDYs7Q28w27fpK2bljKxz0KQIAblu1i73GezTU2IFpW7QPQcK4Hp5AVuVhG99yuv15SKsTqng%2BonPXMP92Pc0qEHesmZ74eYjbRSXFGQ62gN2mA%2FVggLYAnAwjtbVRrAuoAiUy0FvX5PQOCbnfNYGGKUbGgBpe88t3%2Fnp%2Bgc%2BShS8fH5brOT8M%2BSZyCrIZm8RQ9iajxiJc5cDgupVotjH2d10Aok4YylervqdyTmUIqQiZgL3PisMTO3zR48RMdzmArGTSwSaHa0Gti0yYa51kZouh4peEoFwYyBFQyEJYiEAzUhX%2BUdw5ejnSCQ23qEZe5LVVGMEYPPrfXXYg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A26%3A04&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172603758759&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 17:26:04 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=hK0ytDYs7Q28w27fpK2bljKxz0KQIAblu1i73GezTU2IFpW7QPQcK4Hp5AVuVhG99yuv15SKsTqng%2BonPXMP92Pc0qEHesmZ74eYjbRSXFGQ62gN2mA%2FVggLYAnAwjtbVRrAuoAiUy0FvX5PQOCbnfNYGGKUbGgBpe88t3%2Fnp%2Bgc%2BShS8fH5brOT8M%2BSZyCrIZm8RQ9iajxiJc5cDgupVotjH2d10Aok4YylervqdyTmUIqQiZgL3PisMTO3zR48RMdzmArGTSwSaHa0Gti0yYa51kZouh4peEoFwYyBFQyEJYiEAzUhX%2BUdw5ejnSCQ23qEZe5LVVGMEYPPrfXXYg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A26%3A04&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172603758759&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 17:26:04 [http-nio-8087-exec-4] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$998a9503.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$9a3f561d.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 17:28:01 [http-nio-8087-exec-10] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821281"}
2020-01-12 17:28:01 [http-nio-8087-exec-10] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:28:01 [http-nio-8087-exec-10] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"33aa26e93b007c10772aa6e30a2a0176","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821281"}
2020-01-12 17:28:01 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjMzYWEyNmU5M2IwMDdjMTA3NzJhYTZlMzBhMmEwMTc2IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjEyODEifQ==
2020-01-12 17:28:01 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"33aa26e93b007c10772aa6e30a2a0176","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821281"}
2020-01-12 17:28:01 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578821281"}
2020-01-12 17:28:01 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:28:01 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:33aa26e93b007c10772aa6e30a2a0176
2020-01-12 17:28:02 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:28:02 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:28:02 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:28:02 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112172801853638
2020-01-12 17:28:02 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 17:28:02 [http-nio-8087-exec-1] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112172801853638","order_price":15.00}
2020-01-12 17:28:02 [http-nio-8087-exec-1] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=FIAOkjq%2B1TYkHXv3aXjHm9fcuMl6dn9NYEbZH6Xz0xMBENf5QtbrQCq8ITHzVUsmKGHEUslY%2FR3y1ypFo5Bhm7Jp2vf7nZKIY%2BpHm1yUu4EwFfgjY7lNG4%2BmVKWZL9kNr5XI2wpuhpMYwIa2VetOPtpO52nW8QfH9JfHV2OLAzuVyeMp0o%2Bj2A3CIu4yH6K%2Bt1uyWASw73R%2F%2BjhOpnH4%2BflFKY9hDzqqoa22SDcbcZQJQR47xgokzqbccd00MSTJEcJO0S09b%2FPxoGuentKS6sq5eO%2BhbSgoEe35X9iBNr1qni%2B8V9FhC%2FKx%2BPoLZ7vzUj04NmlLS4mlcW2vzEtQaQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A28%3A02&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172801853638&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 17:28:02 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=FIAOkjq%2B1TYkHXv3aXjHm9fcuMl6dn9NYEbZH6Xz0xMBENf5QtbrQCq8ITHzVUsmKGHEUslY%2FR3y1ypFo5Bhm7Jp2vf7nZKIY%2BpHm1yUu4EwFfgjY7lNG4%2BmVKWZL9kNr5XI2wpuhpMYwIa2VetOPtpO52nW8QfH9JfHV2OLAzuVyeMp0o%2Bj2A3CIu4yH6K%2Bt1uyWASw73R%2F%2BjhOpnH4%2BflFKY9hDzqqoa22SDcbcZQJQR47xgokzqbccd00MSTJEcJO0S09b%2FPxoGuentKS6sq5eO%2BhbSgoEe35X9iBNr1qni%2B8V9FhC%2FKx%2BPoLZ7vzUj04NmlLS4mlcW2vzEtQaQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A28%3A02&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172801853638&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 17:28:20 [http-nio-8087-exec-1] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$998a9503.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$9a3f561d.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 17:28:53 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:28:55 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:28:56 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:28:56 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:29:05 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821344"}
2020-01-12 17:29:05 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:29:05 [http-nio-8087-exec-1] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"00b83f4e6db9906027993737743ac6d8","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821344"}
2020-01-12 17:29:05 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjAwYjgzZjRlNmRiOTkwNjAyNzk5MzczNzc0M2FjNmQ4IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjEzNDQifQ==
2020-01-12 17:29:05 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"00b83f4e6db9906027993737743ac6d8","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821344"}
2020-01-12 17:29:05 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578821344"}
2020-01-12 17:29:05 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:29:05 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:00b83f4e6db9906027993737743ac6d8
2020-01-12 17:29:05 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:29:05 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:29:05 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:29:05 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112172905213499
2020-01-12 17:29:05 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 17:29:09 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112172905213499","order_price":15.00}
2020-01-12 17:29:10 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=Jgrh3LLjOupAUx%2FiOaYwVsvNWAkPJxD1YS3aopDh0g76E1K0Uv5u7CY9HkdABJ%2BV9%2F4%2B453AuPLeN0B0pxD6H9ANx6AaiHXN8Ex67fT8kqYCvErf1irUy0gWZVm2NVgbaLn3mxDigNoh1fAp6e%2F4kjoQ%2BCXwOz%2BD7ZKCeVH7ASowuUhCHAvucvNSVbuUFpqtBtmj5Ai3%2B19idD7byrKw70dm9qWpKBIoVII51Dqv7NhApRyCVi1%2BJN2AyFkRFvVSuPFR2qY4G6lrR8%2B5Eo8K9LAqg%2FmgYHXdwVOvPQKHypwlrm6gzRbnXYGZQDQZ%2Bh%2FWDKwGajSNLdVs0Iaio0OG9Q%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A29%3A09&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172905213499&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 17:29:19 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=Jgrh3LLjOupAUx%2FiOaYwVsvNWAkPJxD1YS3aopDh0g76E1K0Uv5u7CY9HkdABJ%2BV9%2F4%2B453AuPLeN0B0pxD6H9ANx6AaiHXN8Ex67fT8kqYCvErf1irUy0gWZVm2NVgbaLn3mxDigNoh1fAp6e%2F4kjoQ%2BCXwOz%2BD7ZKCeVH7ASowuUhCHAvucvNSVbuUFpqtBtmj5Ai3%2B19idD7byrKw70dm9qWpKBIoVII51Dqv7NhApRyCVi1%2BJN2AyFkRFvVSuPFR2qY4G6lrR8%2B5Eo8K9LAqg%2FmgYHXdwVOvPQKHypwlrm6gzRbnXYGZQDQZ%2Bh%2FWDKwGajSNLdVs0Iaio0OG9Q%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A29%3A09&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172905213499&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 17:29:28 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$315388a7.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$320849c1.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 17:29:31 [http-nio-8087-exec-7] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821371"}
2020-01-12 17:29:31 [http-nio-8087-exec-7] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:29:31 [http-nio-8087-exec-7] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"558842572caaba58b74b073abb32736d","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821371"}
2020-01-12 17:29:31 [http-nio-8087-exec-8] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjU1ODg0MjU3MmNhYWJhNThiNzRiMDczYWJiMzI3MzZkIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjEzNzEifQ==
2020-01-12 17:29:31 [http-nio-8087-exec-8] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"558842572caaba58b74b073abb32736d","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578821371"}
2020-01-12 17:29:31 [http-nio-8087-exec-8] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578821371"}
2020-01-12 17:29:31 [http-nio-8087-exec-8] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:29:31 [http-nio-8087-exec-8] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:558842572caaba58b74b073abb32736d
2020-01-12 17:29:31 [http-nio-8087-exec-8] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:29:31 [http-nio-8087-exec-8] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:29:31 [http-nio-8087-exec-8] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:29:31 [http-nio-8087-exec-8] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112172931396846
2020-01-12 17:29:31 [http-nio-8087-exec-8] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 17:29:33 [http-nio-8087-exec-8] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112172931396846","order_price":15.00}
2020-01-12 17:29:37 [http-nio-8087-exec-8] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=ehfReDehrEqMCWfGvfb1x5%2FawwOKuwjCLZBZFvt%2BnSwISn%2FDPgp0n0tYPbWLD9b4681%2FuOJ05ekzSVCFlbTKST%2FnwyBoZykeq5pRw7dc7ZUepgkdFcZR0vna2CbkhjP2MnfgDQyoHPVKl%2BBMFArmyQANwS%2FugCCYrE%2FTGv%2BrUzOV2mbYbf1GxXjDqBY41T0piZL7yStdfOyGKd2L17UNZ7eQ9dq7no6Kau3rDYkpD%2BwNr1wlp7uh5ITC%2FdEMlBqfxmTtmctH558mYtawPa3CzqyVQtpSWYWCXfa%2FEaCoECgZGUA8uk9VgUypwGvsPbZtNymx%2BnlXFG6Qocelr2DRgw%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A29%3A35&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172931396846&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 17:30:24 [http-nio-8087-exec-8] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=ehfReDehrEqMCWfGvfb1x5%2FawwOKuwjCLZBZFvt%2BnSwISn%2FDPgp0n0tYPbWLD9b4681%2FuOJ05ekzSVCFlbTKST%2FnwyBoZykeq5pRw7dc7ZUepgkdFcZR0vna2CbkhjP2MnfgDQyoHPVKl%2BBMFArmyQANwS%2FugCCYrE%2FTGv%2BrUzOV2mbYbf1GxXjDqBY41T0piZL7yStdfOyGKd2L17UNZ7eQ9dq7no6Kau3rDYkpD%2BwNr1wlp7uh5ITC%2FdEMlBqfxmTtmctH558mYtawPa3CzqyVQtpSWYWCXfa%2FEaCoECgZGUA8uk9VgUypwGvsPbZtNymx%2BnlXFG6Qocelr2DRgw%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A29%3A35&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112172931396846&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 17:30:28 [http-nio-8087-exec-8] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$315388a7.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$320849c1.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 17:48:03 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:48:06 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:48:07 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:48:07 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:48:31 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578822511"}
2020-01-12 17:48:31 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:48:31 [http-nio-8087-exec-5] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"0169b3797995f879ae21c352137f348a","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578822511"}
2020-01-12 17:48:31 [http-nio-8087-exec-6] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjAxNjliMzc5Nzk5NWY4NzlhZTIxYzM1MjEzN2YzNDhhIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjI1MTEifQ==
2020-01-12 17:48:31 [http-nio-8087-exec-6] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"0169b3797995f879ae21c352137f348a","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578822511"}
2020-01-12 17:48:31 [http-nio-8087-exec-6] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578822511"}
2020-01-12 17:48:31 [http-nio-8087-exec-6] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:48:31 [http-nio-8087-exec-6] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:0169b3797995f879ae21c352137f348a
2020-01-12 17:48:31 [http-nio-8087-exec-6] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:48:31 [http-nio-8087-exec-6] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:48:31 [http-nio-8087-exec-6] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:48:31 [http-nio-8087-exec-6] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112174831421354
2020-01-12 17:48:31 [http-nio-8087-exec-6] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 17:48:31 [http-nio-8087-exec-6] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112174831421354","order_price":15.00}
2020-01-12 17:48:32 [http-nio-8087-exec-6] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=GKlC4%2FoCogRI0FmXrlG58Ko6VX%2BTlJPrTb1%2Fa8uq6xIScpwqKWwngYlrRGsG1DW1hmRN6v7Hk%2F3ffJqccC1u4gFHFJEY9QMQZaVh%2FCRtTyMOLqeLnEQbGy9RhsqjA%2BWqDNkBd0mQGSKnEDya5NRFB4YLHeoTdM%2BF%2F8w%2Fhr66Np709kTMnXErDyzZe%2FvJhvYV2lTN5AVSh%2FTWQPe%2BIh9%2BQ2ds%2B1PnVOhvPMDmo16orrYmDj2fxfKihxg8xWctteojwJo94dcbSbxsXfeiuNjIz5wzl%2FIywQiWJaJX9Q4wcvO8VuEyhRxT6HFE4U%2FvpjB0hHN0MV6upA0yt9StwptUVQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A48%3A31&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112174831421354&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 17:48:32 [http-nio-8087-exec-6] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=GKlC4%2FoCogRI0FmXrlG58Ko6VX%2BTlJPrTb1%2Fa8uq6xIScpwqKWwngYlrRGsG1DW1hmRN6v7Hk%2F3ffJqccC1u4gFHFJEY9QMQZaVh%2FCRtTyMOLqeLnEQbGy9RhsqjA%2BWqDNkBd0mQGSKnEDya5NRFB4YLHeoTdM%2BF%2F8w%2Fhr66Np709kTMnXErDyzZe%2FvJhvYV2lTN5AVSh%2FTWQPe%2BIh9%2BQ2ds%2B1PnVOhvPMDmo16orrYmDj2fxfKihxg8xWctteojwJo94dcbSbxsXfeiuNjIz5wzl%2FIywQiWJaJX9Q4wcvO8VuEyhRxT6HFE4U%2FvpjB0hHN0MV6upA0yt9StwptUVQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A48%3A31&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112174831421354&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 17:48:32 [http-nio-8087-exec-6] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$95c504ed.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$9679c607.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 17:49:01 [http-nio-8087-exec-4] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578822541"}
2020-01-12 17:49:01 [http-nio-8087-exec-4] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:49:01 [http-nio-8087-exec-4] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"069fd40c576d71dddc1b1f3ac8f4b581","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578822541"}
2020-01-12 17:49:01 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjA2OWZkNDBjNTc2ZDcxZGRkYzFiMWYzYWM4ZjRiNTgxIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjI1NDEifQ==
2020-01-12 17:49:01 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"069fd40c576d71dddc1b1f3ac8f4b581","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578822541"}
2020-01-12 17:49:01 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578822541"}
2020-01-12 17:49:01 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:49:01 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:069fd40c576d71dddc1b1f3ac8f4b581
2020-01-12 17:49:02 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:49:02 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:49:02 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:49:02 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112174901921251
2020-01-12 17:49:02 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 17:49:02 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112174901921251","order_price":15.00}
2020-01-12 17:49:02 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=LX%2FHR%2FK6aKsdJX%2FRZZ884mCULrZ%2FXT6w3EiUnAQMPFmJvt5kLOB8HYD0yk9zXv4%2FkLPYLLK6mae5wWbDJo%2Fv%2BdixmK%2Bh3YK%2FMvECwcaz488J3WSrMIdz7fbsOa2xCUdiDV%2F6UE8ESV0uPwljf6LW%2BMe4zASLZpAiOfi2sRDhSw74VR1xmcXRnzugX5H4gTaWNHfBHf0XOeHGQGkSTOiiVLOyiYsRBa8YKNOvcEWFE6Dd6xvQxaHap09tjiGuWrAB9EErmFU65P8KugruEHjqwCIPSgB8c3mBB%2BjrAt26hI53acc%2Fg66VHy5lLbg6givGgrL83hUOFfO3u1a%2BT2hDXg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A49%3A02&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112174901921251&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 17:49:02 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=LX%2FHR%2FK6aKsdJX%2FRZZ884mCULrZ%2FXT6w3EiUnAQMPFmJvt5kLOB8HYD0yk9zXv4%2FkLPYLLK6mae5wWbDJo%2Fv%2BdixmK%2Bh3YK%2FMvECwcaz488J3WSrMIdz7fbsOa2xCUdiDV%2F6UE8ESV0uPwljf6LW%2BMe4zASLZpAiOfi2sRDhSw74VR1xmcXRnzugX5H4gTaWNHfBHf0XOeHGQGkSTOiiVLOyiYsRBa8YKNOvcEWFE6Dd6xvQxaHap09tjiGuWrAB9EErmFU65P8KugruEHjqwCIPSgB8c3mBB%2BjrAt26hI53acc%2Fg66VHy5lLbg6givGgrL83hUOFfO3u1a%2BT2hDXg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A49%3A02&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112174901921251&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 17:50:03 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$95c504ed.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$9679c607.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 17:52:34 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:52:36 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:52:37 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:52:37 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:53:03 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578822783"}
2020-01-12 17:53:03 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:53:03 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"d533ea06cfd67d4fc1a69cbda4d227c0","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578822783"}
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6ImQ1MzNlYTA2Y2ZkNjdkNGZjMWE2OWNiZGE0ZDIyN2MwIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjI3ODMifQ==
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"d533ea06cfd67d4fc1a69cbda4d227c0","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578822783"}
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578822783"}
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:d533ea06cfd67d4fc1a69cbda4d227c0
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112175303362379
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112175303362379","order_price":15.00}
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=XDsJMvUeApN6RbpOxuiw%2FWG5%2FoxJxDYAw32Tk2o21dS6E74ddNhRA%2FQcmQqjQis62C5g4ex9e%2ByAUuE8LJ87ZF5PAM2sgwfnapQDa%2F4e7GOzAl7jdvnL8O7MMOmqSBi%2BvOU%2FaoowteVL5kVbtvb3N1uIe%2Fuk6wYyBjiOTuhtSzoxlc4lMosn0OrOdPoKV1FNL6qkeKNgrznkKwfnK2kXM92xrWUc6TDK1BuBjjswzFioRkTDO4aLq0i%2BR%2F6Q4l88qhwt2HLkQvbovwLdeFUA0oZip6zAj6mx1tG4Om4J%2FSaqXwTYFyCD47o7QYDWJfPhuOTRjzGwGc1Rwy68vxKYCg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A53%3A03&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112175303362379&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 17:53:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=XDsJMvUeApN6RbpOxuiw%2FWG5%2FoxJxDYAw32Tk2o21dS6E74ddNhRA%2FQcmQqjQis62C5g4ex9e%2ByAUuE8LJ87ZF5PAM2sgwfnapQDa%2F4e7GOzAl7jdvnL8O7MMOmqSBi%2BvOU%2FaoowteVL5kVbtvb3N1uIe%2Fuk6wYyBjiOTuhtSzoxlc4lMosn0OrOdPoKV1FNL6qkeKNgrznkKwfnK2kXM92xrWUc6TDK1BuBjjswzFioRkTDO4aLq0i%2BR%2F6Q4l88qhwt2HLkQvbovwLdeFUA0oZip6zAj6mx1tG4Om4J%2FSaqXwTYFyCD47o7QYDWJfPhuOTRjzGwGc1Rwy68vxKYCg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A53%3A03&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112175303362379&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 17:53:10 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$e91c67c.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$f468796.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 17:57:17 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 17:57:20 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 17:57:20 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 17:57:20 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 17:57:42 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823062"}
2020-01-12 17:57:42 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:57:42 [http-nio-8087-exec-3] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"2b16fcd95654bd191d871915770634f5","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823062"}
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjJiMTZmY2Q5NTY1NGJkMTkxZDg3MTkxNTc3MDYzNGY1IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjMwNjIifQ==
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"2b16fcd95654bd191d871915770634f5","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823062"}
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578823062"}
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:2b16fcd95654bd191d871915770634f5
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112175742343766
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112175742343766","order_price":15.00}
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=Bx6sev3OaXSmRXxcjj9T%2BUu2x2nPqMu2TjMEPIw%2BbJUxBTT%2FEeFbsDD0iyHcui04PdgR51Z9bHfSJEFCw6OCRsBR%2FDz7bkdXKwqFrQgIrpCb1yAtE8CPgo7sZyzkmu4YXYqbAfDZ8oGlS9AEi99WwXnSJC6LyE5EmKQZXwiUXumSGGdCig6jV8KSdtl4PmUwolbtABFkXmQ6JpkFtKBkifHAr79csclT7jaFRWdY1uqzk5bAW2Q27HA91tFoop2J6KZFedH9gS%2B7D2m9E9JhsYYlFJ%2FsQ50NQSMzzmfUtwUU4u6IGjm4wbwzQmPB%2B9k9Q3EFir3t0LlCJKeHSfvvPw%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A57%3A42&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112175742343766&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 17:57:42 [http-nio-8087-exec-4] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=Bx6sev3OaXSmRXxcjj9T%2BUu2x2nPqMu2TjMEPIw%2BbJUxBTT%2FEeFbsDD0iyHcui04PdgR51Z9bHfSJEFCw6OCRsBR%2FDz7bkdXKwqFrQgIrpCb1yAtE8CPgo7sZyzkmu4YXYqbAfDZ8oGlS9AEi99WwXnSJC6LyE5EmKQZXwiUXumSGGdCig6jV8KSdtl4PmUwolbtABFkXmQ6JpkFtKBkifHAr79csclT7jaFRWdY1uqzk5bAW2Q27HA91tFoop2J6KZFedH9gS%2B7D2m9E9JhsYYlFJ%2FsQ50NQSMzzmfUtwUU4u6IGjm4wbwzQmPB%2B9k9Q3EFir3t0LlCJKeHSfvvPw%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+17%3A57%3A42&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112175742343766&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 17:57:42 [http-nio-8087-exec-4] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$d66709d2.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$d71bcaec.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 18:02:13 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:02:15 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 18:02:16 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 18:02:16 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 18:02:31 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823351"}
2020-01-12 18:02:31 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:02:31 [http-nio-8087-exec-3] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"054493afa0e47ab2b4f22fe8aec116e2","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823351"}
2020-01-12 18:02:31 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjA1NDQ5M2FmYTBlNDdhYjJiNGYyMmZlOGFlYzExNmUyIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjMzNTEifQ==
2020-01-12 18:02:31 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"054493afa0e47ab2b4f22fe8aec116e2","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823351"}
2020-01-12 18:02:31 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578823351"}
2020-01-12 18:02:31 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:02:31 [http-nio-8087-exec-5] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:054493afa0e47ab2b4f22fe8aec116e2
2020-01-12 18:02:31 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:02:31 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:02:31 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:02:31 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112180231572792
2020-01-12 18:02:31 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:02:31 [http-nio-8087-exec-5] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112180231572792","order_price":15.00}
2020-01-12 18:02:32 [http-nio-8087-exec-5] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=WlevqDtnbdPXjFTdo52ZE2irjZ0k6k1dX5DNZNER2aEc1EGRbpqrWZ7sO363p%2BZ7gEeSGoWbpg1qN90ITY5tGYZzt6dQ096HnLKiR0nqki%2BV3r7ogaiFCo7g4%2FzqFyUCa%2FSIe9C8QsfUp3TmH1qYSamsjpeRc3p7L1Gc%2BT6tDnC2oV7gTFXGitB%2FG6qDDj0orroe0oFSBaFNp44VHhHoU3%2BeA3SOgurehlTf%2FbLTmYqvbQtdDAwjOhDdywoRwH62KkczmQ09mg7Bfdi0O9FnQEwj%2BSSX%2BMcBRQ4EQ%2BAEYvKg5WNeKqAg%2BfrUxmHEZT3rLRT2nrTm9DluL0MskbzQxw%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A02%3A31&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112180231572792&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:02:32 [http-nio-8087-exec-5] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=WlevqDtnbdPXjFTdo52ZE2irjZ0k6k1dX5DNZNER2aEc1EGRbpqrWZ7sO363p%2BZ7gEeSGoWbpg1qN90ITY5tGYZzt6dQ096HnLKiR0nqki%2BV3r7ogaiFCo7g4%2FzqFyUCa%2FSIe9C8QsfUp3TmH1qYSamsjpeRc3p7L1Gc%2BT6tDnC2oV7gTFXGitB%2FG6qDDj0orroe0oFSBaFNp44VHhHoU3%2BeA3SOgurehlTf%2FbLTmYqvbQtdDAwjOhDdywoRwH62KkczmQ09mg7Bfdi0O9FnQEwj%2BSSX%2BMcBRQ4EQ%2BAEYvKg5WNeKqAg%2BfrUxmHEZT3rLRT2nrTm9DluL0MskbzQxw%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A02%3A31&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112180231572792&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:02:32 [http-nio-8087-exec-5] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$d3da5d4d.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$d48f1e67.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:169)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 18:04:33 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:04:35 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 18:04:36 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 18:04:36 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 18:04:54 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823494"}
2020-01-12 18:04:54 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:04:54 [http-nio-8087-exec-1] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"da858c7a0fb4de3aa0a1c632fe794229","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823494"}
2020-01-12 18:04:54 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6ImRhODU4YzdhMGZiNGRlM2FhMGExYzYzMmZlNzk0MjI5IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjM0OTQifQ==
2020-01-12 18:04:54 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"da858c7a0fb4de3aa0a1c632fe794229","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823494"}
2020-01-12 18:04:54 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578823494"}
2020-01-12 18:04:54 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:04:54 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:da858c7a0fb4de3aa0a1c632fe794229
2020-01-12 18:04:54 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:04:54 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:04:54 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:04:54 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112180454633456
2020-01-12 18:04:54 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:04:54 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112180454633456","order_price":15.00}
2020-01-12 18:04:55 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=hI9o%2BmLi%2BZCnvRqdptc3w3T6EyYz%2FNINGuJ1hna6WIkW3r%2BxQy%2BZNlb8jI9yWif9154HjLASGLpq8pU0SE5mpoqooDsB%2FpkH6KOtxsYklgpsu5C%2B2BdwxPQ2QtQcjLHTQyGcRNMAoZwKWm%2F6f4hlTBL1dvkel0bXUdt%2FPKnmGg3AZJcFMtf3%2Bmr8yq0ZXNL6qeCH%2Bu%2FwsHGbFypMdDzvGPI7C33OILFLxAn8JZEFHL0K%2FHHA5UWhXRC2i2wf4GvbGHvWFfehlLLJEeghYYxAUN2zQPtdEOq6w38BD9c03Lv27q6pyZAIbGjIG75cQ5Zs722Wuuvq9Ha0SqpX8H1xoQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A04%3A54&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112180454633456&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:04:55 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=hI9o%2BmLi%2BZCnvRqdptc3w3T6EyYz%2FNINGuJ1hna6WIkW3r%2BxQy%2BZNlb8jI9yWif9154HjLASGLpq8pU0SE5mpoqooDsB%2FpkH6KOtxsYklgpsu5C%2B2BdwxPQ2QtQcjLHTQyGcRNMAoZwKWm%2F6f4hlTBL1dvkel0bXUdt%2FPKnmGg3AZJcFMtf3%2Bmr8yq0ZXNL6qeCH%2Bu%2FwsHGbFypMdDzvGPI7C33OILFLxAn8JZEFHL0K%2FHHA5UWhXRC2i2wf4GvbGHvWFfehlLLJEeghYYxAUN2zQPtdEOq6w38BD9c03Lv27q6pyZAIbGjIG75cQ5Zs722Wuuvq9Ha0SqpX8H1xoQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A04%3A54&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112180454633456&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:04:55 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$403dc5c9.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$f3e97c14.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 71 more
2020-01-12 18:06:52 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:06:54 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 18:06:55 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 18:06:55 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 18:07:07 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823627"}
2020-01-12 18:07:07 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:07:07 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"ef72a9ba6e3c296f413793a5a31d9eb2","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823627"}
2020-01-12 18:07:07 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6ImVmNzJhOWJhNmUzYzI5NmY0MTM3OTNhNWEzMWQ5ZWIyIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjM2MjcifQ==
2020-01-12 18:07:07 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"ef72a9ba6e3c296f413793a5a31d9eb2","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823627"}
2020-01-12 18:07:07 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578823627"}
2020-01-12 18:07:07 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:07:07 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:ef72a9ba6e3c296f413793a5a31d9eb2
2020-01-12 18:07:07 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:07:07 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:07:07 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:07:07 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112180707737682
2020-01-12 18:07:07 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:07:07 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112180707737682","order_price":15.00}
2020-01-12 18:07:08 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=J3tQSXi6GGN%2Br7QSYo9sLM9V76ET8AXWJKNqAWRthHXjOV0cvoH74MLrOtYfLyRrebcTtt5wHUuQ9wtIkfmrjaQmQ39lq8MMUSdJC2adfxE%2Ba06TEnv%2FwPsOXTD4WZlO2ZIfZlaN0CC4BBuXArXanwWKKGSetPJpzCLKymFkLkHsZgSRKnodvz70IMrG%2BXsCG%2Byn40yoag1di1KVMuCmZVJuGRpk530vlGGe%2B7BGrn%2F69zuY7rPaDyYedaE7GvorObKsl9qJq7qQQjJ6uPRsLRJdk6C72YIW20ApMxFFBaf%2BGnJSzLnmhvj706kuOMlI6%2F33H%2BCxRjPW4qKUkE4b8w%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A07%3A07&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112180707737682&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:07:08 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=J3tQSXi6GGN%2Br7QSYo9sLM9V76ET8AXWJKNqAWRthHXjOV0cvoH74MLrOtYfLyRrebcTtt5wHUuQ9wtIkfmrjaQmQ39lq8MMUSdJC2adfxE%2Ba06TEnv%2FwPsOXTD4WZlO2ZIfZlaN0CC4BBuXArXanwWKKGSetPJpzCLKymFkLkHsZgSRKnodvz70IMrG%2BXsCG%2Byn40yoag1di1KVMuCmZVJuGRpk530vlGGe%2B7BGrn%2F69zuY7rPaDyYedaE7GvorObKsl9qJq7qQQjJ6uPRsLRJdk6C72YIW20ApMxFFBaf%2BGnJSzLnmhvj706kuOMlI6%2F33H%2BCxRjPW4qKUkE4b8w%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A07%3A07&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112180707737682&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:07:08 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$d1cbe559.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$d280a673.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 67 more
2020-01-12 18:07:31 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:07:34 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 18:07:34 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 18:07:34 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 18:08:12 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823692"}
2020-01-12 18:08:12 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:08:12 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"17d17093564d6e7840b98959b9c127a3","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823692"}
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjE3ZDE3MDkzNTY0ZDZlNzg0MGI5ODk1OWI5YzEyN2EzIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjM2OTIifQ==
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"17d17093564d6e7840b98959b9c127a3","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823692"}
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578823692"}
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:17d17093564d6e7840b98959b9c127a3
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112180813080141
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112180813080141","order_price":15.00}
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=XH3jvlI0Dy0O5cv0J4UDPLJGNQJHxqWJLYrgnwlcL7VkPIlRpzZOv9IblP8nYds%2Fm%2FscjMZr0tlWBud64h9gZGp41SiskBPPU8oxu1rPsDAjJY%2FSkyotelOe56ZV%2BJ%2FwnDj9xLoJ2pYtJsbOh5WubwY7RIKg3Q4KspivsnlUIe4%2B%2Fel6wTVeSB7rKTyHUkLQEYUF0mHwYzt8SkriOkEHnviR67ui5FQ6NGyk%2FeiG2rbYJ1xg4hXlBIzr0hPCl7ByyhinL75I9F5CyKMNQQ8iiuL2tx64Z5W3b14P7Crad5bqkqwMoVbvQxa5G9QI%2BSvijjh2xA0Q0BifE3Gb%2FjD9ww%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A08%3A13&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112180813080141&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:08:13 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=XH3jvlI0Dy0O5cv0J4UDPLJGNQJHxqWJLYrgnwlcL7VkPIlRpzZOv9IblP8nYds%2Fm%2FscjMZr0tlWBud64h9gZGp41SiskBPPU8oxu1rPsDAjJY%2FSkyotelOe56ZV%2BJ%2FwnDj9xLoJ2pYtJsbOh5WubwY7RIKg3Q4KspivsnlUIe4%2B%2Fel6wTVeSB7rKTyHUkLQEYUF0mHwYzt8SkriOkEHnviR67ui5FQ6NGyk%2FeiG2rbYJ1xg4hXlBIzr0hPCl7ByyhinL75I9F5CyKMNQQ8iiuL2tx64Z5W3b14P7Crad5bqkqwMoVbvQxa5G9QI%2BSvijjh2xA0Q0BifE3Gb%2FjD9ww%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A08%3A13&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112180813080141&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:08:13 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$c00b5ace.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$c0c01be8.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:167)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 67 more
2020-01-12 18:09:38 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:09:40 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 18:09:41 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 18:09:41 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 18:09:50 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823790"}
2020-01-12 18:09:50 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:09:50 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"3aab107c717d898de2669d8aedcf16ba","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823790"}
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjNhYWIxMDdjNzE3ZDg5OGRlMjY2OWQ4YWVkY2YxNmJhIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjM3OTAifQ==
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"3aab107c717d898de2669d8aedcf16ba","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578823790"}
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578823790"}
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:3aab107c717d898de2669d8aedcf16ba
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112180950264691
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112180950264691","order_price":15.00}
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=IF2NDdTgHrpA0czNVFLBQ4hE7fZ2G0Z%2F3D6LI0pDU8%2F5gCeDQ9WiiZSl2VyqV9wyqaSlNLTjHWCb8juyGDc7I6XZdkXuXbW%2FmRcDn5Xbt0OkkpG%2BZzytl7j9nYt5VwAGG2nr57QRnmz1xlquz%2BLn1ZF79svwncF7%2FWD5tduIH0AnLOIWKWimHqKMrl%2BYvGP%2BNmaMm5CObZ8M4w7mwfmHzoPiUPkFdQCooz3Cr7bmzaP3Nv%2By9k5WH9w40YMyLVgjl5vRoFEmSH3ob5mSghqX7J3QfGDAcWYWm%2ByN%2BStfldZun5V6m6L1KjF0RPHROReYSje8dwz7fDEmK5h7oLxdEQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A09%3A50&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112180950264691&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:09:50 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=IF2NDdTgHrpA0czNVFLBQ4hE7fZ2G0Z%2F3D6LI0pDU8%2F5gCeDQ9WiiZSl2VyqV9wyqaSlNLTjHWCb8juyGDc7I6XZdkXuXbW%2FmRcDn5Xbt0OkkpG%2BZzytl7j9nYt5VwAGG2nr57QRnmz1xlquz%2BLn1ZF79svwncF7%2FWD5tduIH0AnLOIWKWimHqKMrl%2BYvGP%2BNmaMm5CObZ8M4w7mwfmHzoPiUPkFdQCooz3Cr7bmzaP3Nv%2By9k5WH9w40YMyLVgjl5vRoFEmSH3ob5mSghqX7J3QfGDAcWYWm%2ByN%2BStfldZun5V6m6L1KjF0RPHROReYSje8dwz7fDEmK5h7oLxdEQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A09%3A50&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112180950264691&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:09:50 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$f5d55c2c.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$f68a1d46.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:168)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 18:15:54 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:15:57 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 18:15:57 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 18:15:57 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 18:16:03 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824163"}
2020-01-12 18:16:03 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:16:03 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"56493bd84f7e14489761cdf28e2ff08a","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824163"}
2020-01-12 18:16:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjU2NDkzYmQ4NGY3ZTE0NDg5NzYxY2RmMjhlMmZmMDhhIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjQxNjMifQ==
2020-01-12 18:16:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"56493bd84f7e14489761cdf28e2ff08a","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824163"}
2020-01-12 18:16:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578824163"}
2020-01-12 18:16:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:16:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:56493bd84f7e14489761cdf28e2ff08a
2020-01-12 18:16:04 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:16:04 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:16:04 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:16:04 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112181603827497
2020-01-12 18:16:04 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:16:04 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112181603827497","order_price":15.00}
2020-01-12 18:16:04 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=MVTh35rs94bdXCvxPYk0UQrqmkjIiYbBDJxYsP3joH%2BpkD3ANnLjj5V93HPT2Um563quU7xw%2FmegJtCNa3l%2FbooJsUxxSfuTFJsC8m%2FudgwW8XJHUCeWhW8mQ2FLKdKK1D0gau%2FvTy6mvRLzscSMD9Cb9bs2Z%2B%2F7kDwV5wRS9cbICa%2Fj6NdWMrOhFYhVdh7NzGjr0kNsSSg%2FgKo11nQxuAfHFAGCM%2Bjv8neix44w1J%2Fmen3qrnyrOgmejp7hgtatJ%2BscUHE1IXfDuG%2Blx9G7IH7WJKFOGYBLaJPyvsQY0wlMCftv0TZxNQ%2FOexIRiy99EztpzJ%2F7h3q1utGoWjFwvg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A16%3A04&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112181603827497&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:16:04 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=MVTh35rs94bdXCvxPYk0UQrqmkjIiYbBDJxYsP3joH%2BpkD3ANnLjj5V93HPT2Um563quU7xw%2FmegJtCNa3l%2FbooJsUxxSfuTFJsC8m%2FudgwW8XJHUCeWhW8mQ2FLKdKK1D0gau%2FvTy6mvRLzscSMD9Cb9bs2Z%2B%2F7kDwV5wRS9cbICa%2Fj6NdWMrOhFYhVdh7NzGjr0kNsSSg%2FgKo11nQxuAfHFAGCM%2Bjv8neix44w1J%2Fmen3qrnyrOgmejp7hgtatJ%2BscUHE1IXfDuG%2Blx9G7IH7WJKFOGYBLaJPyvsQY0wlMCftv0TZxNQ%2FOexIRiy99EztpzJ%2F7h3q1utGoWjFwvg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A16%3A04&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112181603827497&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:16:04 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$6f71bc4d.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$70267d67.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:169)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 18:16:23 [http-nio-8087-exec-9] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824183"}
2020-01-12 18:16:23 [http-nio-8087-exec-9] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:16:23 [http-nio-8087-exec-9] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"b80e943c55884b993f82fa171d8d40b5","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824183"}
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6ImI4MGU5NDNjNTU4ODRiOTkzZjgyZmExNzFkOGQ0MGI1IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjQxODMifQ==
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"b80e943c55884b993f82fa171d8d40b5","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824183"}
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578824183"}
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:b80e943c55884b993f82fa171d8d40b5
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112181623360354
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112181623360354","order_price":15.00}
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=V6qrm7ItmPZ%2FWDqcvnNoPHtyTGq1F8vw7doYsYiKnSvRmTpFQKAXTQniSKPAtwvDpbzy6ffktpb247ygSLOiR7Y%2BRog5mRrgKzs5l3XxSDqZUEZHVBdRE%2BL4EUwKnbC8dQEOwnx%2B3LQvYznD6t7ylCczvsX%2FZfLkwuNBuALUIviKFDGxhSk7VFYusIw0E5kYV3zzMlN%2B4nTfDSW3eVyuZUhL1ErrlR3TEyhQZ7GEDios0cnS7v6MWPETrl3FAoola%2Bq0HnSzuUQU50Hr3Gt92oi8NmiO%2FYXbW0K5w1BPYybxwJhK0g1gfbLK063Tn1sXtfg13GZol6YAWg%2FFJsseHQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A16%3A23&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112181623360354&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:16:23 [http-nio-8087-exec-1] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=V6qrm7ItmPZ%2FWDqcvnNoPHtyTGq1F8vw7doYsYiKnSvRmTpFQKAXTQniSKPAtwvDpbzy6ffktpb247ygSLOiR7Y%2BRog5mRrgKzs5l3XxSDqZUEZHVBdRE%2BL4EUwKnbC8dQEOwnx%2B3LQvYznD6t7ylCczvsX%2FZfLkwuNBuALUIviKFDGxhSk7VFYusIw0E5kYV3zzMlN%2B4nTfDSW3eVyuZUhL1ErrlR3TEyhQZ7GEDios0cnS7v6MWPETrl3FAoola%2Bq0HnSzuUQU50Hr3Gt92oi8NmiO%2FYXbW0K5w1BPYybxwJhK0g1gfbLK063Tn1sXtfg13GZol6YAWg%2FFJsseHQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A16%3A23&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112181623360354&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:17:08 [http-nio-8087-exec-1] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$6f71bc4d.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$70267d67.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:169)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 18:17:17 [http-nio-8087-exec-8] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824237"}
2020-01-12 18:17:17 [http-nio-8087-exec-8] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:17:17 [http-nio-8087-exec-8] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"6b89c2d28fb59e6d7dfa6ff474ba8fb1","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824237"}
2020-01-12 18:17:17 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjZiODljMmQyOGZiNTllNmQ3ZGZhNmZmNDc0YmE4ZmIxIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjQyMzcifQ==
2020-01-12 18:17:17 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"6b89c2d28fb59e6d7dfa6ff474ba8fb1","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824237"}
2020-01-12 18:17:17 [http-nio-8087-exec-10] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578824237"}
2020-01-12 18:17:17 [http-nio-8087-exec-10] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:17:17 [http-nio-8087-exec-10] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:6b89c2d28fb59e6d7dfa6ff474ba8fb1
2020-01-12 18:17:18 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:17:18 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:17:18 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:17:18 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112181717962297
2020-01-12 18:17:18 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:17:18 [http-nio-8087-exec-10] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112181717962297","order_price":15.00}
2020-01-12 18:17:18 [http-nio-8087-exec-10] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=dOzbt3KOTCaa8woIZ3EDuRkAepqlEuZ%2BETiD0mh4qF1W05IX%2BnetpzaCw80Sqdi8Q4Vcxub1fq1IpwZcocWQRs51LEv5DRhkxMH%2BYkR3p1a9%2FrdJBK9SYgFwiHv2R4uSqasS1cC9GWZr7ce%2BRwCkwOPwGOiOwT1Zwd4SPwDWbg7iaDGzX2iMv%2F%2F%2BL%2Bfw2ZsfH%2F9hyfCzswxWQa4bCrzdIkYWkM3EK9SB5xftGEdy3%2BxOAEXrArqa02uwUSeZIN4k2VUdMe4p%2FZoXN1tI4njbs%2FtUiEB10DwCFFIf0ZgZMUiznpbCGMG9Lt9x3vBMcH04fDSTxhcsjNZAz3UzcIEZ6w%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A17%3A18&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112181717962297&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:17:18 [http-nio-8087-exec-10] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=dOzbt3KOTCaa8woIZ3EDuRkAepqlEuZ%2BETiD0mh4qF1W05IX%2BnetpzaCw80Sqdi8Q4Vcxub1fq1IpwZcocWQRs51LEv5DRhkxMH%2BYkR3p1a9%2FrdJBK9SYgFwiHv2R4uSqasS1cC9GWZr7ce%2BRwCkwOPwGOiOwT1Zwd4SPwDWbg7iaDGzX2iMv%2F%2F%2BL%2Bfw2ZsfH%2F9hyfCzswxWQa4bCrzdIkYWkM3EK9SB5xftGEdy3%2BxOAEXrArqa02uwUSeZIN4k2VUdMe4p%2FZoXN1tI4njbs%2FtUiEB10DwCFFIf0ZgZMUiznpbCGMG9Lt9x3vBMcH04fDSTxhcsjNZAz3UzcIEZ6w%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A17%3A18&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112181717962297&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:17:54 [http-nio-8087-exec-10] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$6f71bc4d.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$70267d67.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:169)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 18:21:04 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:21:06 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 18:21:07 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 18:21:07 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 18:21:20 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824480"}
2020-01-12 18:21:20 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:21:20 [http-nio-8087-exec-1] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"111733424604404faa4128c4c2068325","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824480"}
2020-01-12 18:21:20 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjExMTczMzQyNDYwNDQwNGZhYTQxMjhjNGMyMDY4MzI1IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjQ0ODAifQ==
2020-01-12 18:21:20 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"111733424604404faa4128c4c2068325","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578824480"}
2020-01-12 18:21:20 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578824480"}
2020-01-12 18:21:20 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:21:20 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:111733424604404faa4128c4c2068325
2020-01-12 18:21:21 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:21:21 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:21:21 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:21:21 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112182121008482
2020-01-12 18:21:21 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:21:21 [http-nio-8087-exec-2] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112182121008482","order_price":15.00}
2020-01-12 18:21:21 [http-nio-8087-exec-2] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=Syd1%2BGSP29WmIoag%2FJbkZIBfyNgXsqfDj6nt%2F3Swy425lFqXi86rbpn0ted7sVzzXvhzEdI3kAQCaV1j%2BQX2d8AZCEzfYP3V%2BOycFVPpHcOZEi59ZVvKnnDFuf66BuT%2BxnhF5%2FjPZ6Zd19ytZPO50XJ0NfWymXU1wldU4NiuqoXQFMrNZoJunK%2FTCNxCJxaFsCPa9yxhx7CmqZ6ptTpyx%2FkGtv7Z1Gl%2FKDs%2B8qm41oVtT72QsxbBEiG2MuUkgYKNQpqU7Gz4K1XGsAU%2Bq%2F3Uwa9SEechlSTX%2FfgcwLhr70ES%2BSTbf9jGswawlE%2Fxv%2BoJ2V2a%2BAw3W8vX59WK0M6MIg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A21%3A21&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112182121008482&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:21:21 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=Syd1%2BGSP29WmIoag%2FJbkZIBfyNgXsqfDj6nt%2F3Swy425lFqXi86rbpn0ted7sVzzXvhzEdI3kAQCaV1j%2BQX2d8AZCEzfYP3V%2BOycFVPpHcOZEi59ZVvKnnDFuf66BuT%2BxnhF5%2FjPZ6Zd19ytZPO50XJ0NfWymXU1wldU4NiuqoXQFMrNZoJunK%2FTCNxCJxaFsCPa9yxhx7CmqZ6ptTpyx%2FkGtv7Z1Gl%2FKDs%2B8qm41oVtT72QsxbBEiG2MuUkgYKNQpqU7Gz4K1XGsAU%2Bq%2F3Uwa9SEechlSTX%2FfgcwLhr70ES%2BSTbf9jGswawlE%2Fxv%2BoJ2V2a%2BAw3W8vX59WK0M6MIg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A21%3A21&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112182121008482&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:21:21 [http-nio-8087-exec-2] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$cb6f2f03.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:54)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$cc23f01d.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:169)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 18:32:32 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:32:36 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 18:32:37 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 18:32:37 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 18:33:03 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578825183"}
2020-01-12 18:33:03 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:33:03 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"000f143926268861939c723ce23204a7","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578825183"}
2020-01-12 18:33:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjAwMGYxNDM5MjYyNjg4NjE5MzljNzIzY2UyMzIwNGE3IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjUxODMifQ==
2020-01-12 18:33:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"000f143926268861939c723ce23204a7","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578825183"}
2020-01-12 18:33:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578825183"}
2020-01-12 18:33:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:33:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:000f143926268861939c723ce23204a7
2020-01-12 18:33:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:33:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:33:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:33:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112183303393726
2020-01-12 18:33:03 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:33:03 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112183303393726","order_price":15.00}
2020-01-12 18:33:04 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=VdR5F5h2xRyQkZNbS6D4DeLwseXyYUSI5LscpxHhS6GlgYov3LCVZipRSHONjy0TJNVQc3mlhADW5qBj5WX%2FOQpKhocJdB4oXMoHje5p%2Fwf6ZA25nmFmZLE2Lt3tsPc%2FANTRG7SM7aLnue5y4WE4Wt1xaYGonlwJDyGz8%2FV%2Fo9LMQwEpSPl2JFyLzHC7eluEVe2jJ5xU2DNzqUJx0VqQSgzslbFY6xRw7hSYJECqtYcvmfqryBaMaqdNouDUgvPYSox%2BzcZ79FNrGBkSXYhrQPLYMbXooS5ezs1dTy7r35GIPQ97D7eMQU%2FYq2ocmbax08czcrxrOkmL5%2BLyfwnMgQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A33%3A03&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112183303393726&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:33:04 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=VdR5F5h2xRyQkZNbS6D4DeLwseXyYUSI5LscpxHhS6GlgYov3LCVZipRSHONjy0TJNVQc3mlhADW5qBj5WX%2FOQpKhocJdB4oXMoHje5p%2Fwf6ZA25nmFmZLE2Lt3tsPc%2FANTRG7SM7aLnue5y4WE4Wt1xaYGonlwJDyGz8%2FV%2Fo9LMQwEpSPl2JFyLzHC7eluEVe2jJ5xU2DNzqUJx0VqQSgzslbFY6xRw7hSYJECqtYcvmfqryBaMaqdNouDUgvPYSox%2BzcZ79FNrGBkSXYhrQPLYMbXooS5ezs1dTy7r35GIPQ97D7eMQU%2FYq2ocmbax08czcrxrOkmL5%2BLyfwnMgQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A33%3A03&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112183303393726&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:33:04 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$eaccd671.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$eb81978b.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:169)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 18:35:24 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:36:10 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:36:41 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:37:54 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:39:04 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:39:07 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 18:39:08 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 18:39:08 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 18:39:39 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:39:41 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 18:39:42 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 18:39:42 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 18:39:57 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578825597"}
2020-01-12 18:39:57 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:39:57 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"966d20beeecb7f27e05b82eabf3b1f54","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578825597"}
2020-01-12 18:39:57 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6Ijk2NmQyMGJlZWVjYjdmMjdlMDViODJlYWJmM2IxZjU0IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjU1OTcifQ==
2020-01-12 18:39:57 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"966d20beeecb7f27e05b82eabf3b1f54","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578825597"}
2020-01-12 18:39:57 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578825597"}
2020-01-12 18:39:57 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:39:57 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:966d20beeecb7f27e05b82eabf3b1f54
2020-01-12 18:39:58 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:39:58 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:39:58 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:39:58 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112183957921324
2020-01-12 18:39:58 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:39:58 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112183957921324","order_price":15.00}
2020-01-12 18:39:58 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=YTFJFRv1AL%2BJdG5Qkq9s41xX0aRyV8UJCa3efIlIKUdgoV5NUooq5EutQAD%2FEmqRthUI2JO%2B%2B1ViSYuuhvhYsmjG0VxDqNrVYMOYz6BaJmdJ71XzitIJiEXmuLJjwyLRZGM21ds1HUBdHx%2BrZhHf2htVbvb%2BONE9dqK0DavYWLL1HR9MfiuG%2FmnjTZ7Tt5z9JxlGzCkeuyT8fvqLSxyeUXrrJ9yzmnteBUsUnUhKw8d9Nz6s5LExsZ71oTpJv%2BjZqojX7be7AFesjFU42ZhWKZzChclHyvWYFNXKBSbL9XotudWjuFwxZ5nkO3LM3Ju3YOUmsPbh1EonDdlsTYwhZg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A39%3A58&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112183957921324&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:39:58 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=YTFJFRv1AL%2BJdG5Qkq9s41xX0aRyV8UJCa3efIlIKUdgoV5NUooq5EutQAD%2FEmqRthUI2JO%2B%2B1ViSYuuhvhYsmjG0VxDqNrVYMOYz6BaJmdJ71XzitIJiEXmuLJjwyLRZGM21ds1HUBdHx%2BrZhHf2htVbvb%2BONE9dqK0DavYWLL1HR9MfiuG%2FmnjTZ7Tt5z9JxlGzCkeuyT8fvqLSxyeUXrrJ9yzmnteBUsUnUhKw8d9Nz6s5LExsZ71oTpJv%2BjZqojX7be7AFesjFU42ZhWKZzChclHyvWYFNXKBSbL9XotudWjuFwxZ5nkO3LM3Ju3YOUmsPbh1EonDdlsTYwhZg%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A39%3A58&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112183957921324&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:39:58 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$6b3419d0.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$6be8daea.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:169)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 18:42:30 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db1  built
2020-01-12 18:42:32 [restartedMain] INFO  [com.yufan.common.DataSourceConfig] - ---------init---------db2  built
2020-01-12 18:42:33 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 18:42:33 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 18:42:40 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578825760"}
2020-01-12 18:42:40 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:42:40 [http-nio-8087-exec-3] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"5ec1c3adb948132d24c38207e276ffcc","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578825760"}
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjVlYzFjM2FkYjk0ODEzMmQyNGMzODIwN2UyNzZmZmNjIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjU3NjAifQ==
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"5ec1c3adb948132d24c38207e276ffcc","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578825760"}
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578825760"}
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:5ec1c3adb948132d24c38207e276ffcc
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112184241087627
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112184241087627","order_price":15.00}
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=DtvzaeBox8alNAGLSSKE1F2B65XGWIZ4A1hiaIH7751gK5VwKe5z%2BYMl6ZXW2aVoDZJBHnzmHOJGl3mBrJFfW65Qt0S%2FMn69380p2mDxpww2uXLl7MoXugE8ZqN%2Fe51CLEWY4Xdjx0OPNTLfyDPJnqhpeYEqRXyBGgP5AggSupNCIzy9OJp010%2BegdKuZPCbKfEJ1j7Pb%2B65s8xSO99C1TIvNqTw6QETcD3BtWGw%2FiuD0A91gbsKdc7EGozCoCkUhrLFPp3f3p6%2FR87%2Fe%2B6EIddmdmsMMhXKrdji%2BKfQYHkds8CQW06Nfe3WYDOdOBcJFZxN8CTr%2BZbSnfEzC8d2Ew%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A42%3A41&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112184241087627&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 18:42:41 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=DtvzaeBox8alNAGLSSKE1F2B65XGWIZ4A1hiaIH7751gK5VwKe5z%2BYMl6ZXW2aVoDZJBHnzmHOJGl3mBrJFfW65Qt0S%2FMn69380p2mDxpww2uXLl7MoXugE8ZqN%2Fe51CLEWY4Xdjx0OPNTLfyDPJnqhpeYEqRXyBGgP5AggSupNCIzy9OJp010%2BegdKuZPCbKfEJ1j7Pb%2B65s8xSO99C1TIvNqTw6QETcD3BtWGw%2FiuD0A91gbsKdc7EGozCoCkUhrLFPp3f3p6%2FR87%2Fe%2B6EIddmdmsMMhXKrdji%2BKfQYHkds8CQW06Nfe3WYDOdOBcJFZxN8CTr%2BZbSnfEzC8d2Ew%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+18%3A42%3A41&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112184241087627&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 18:42:41 [http-nio-8087-exec-2] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$e97a33a3.executeUpdateForSQL(<generated>)
	at com.yufan.dao.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$bee686a3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$ea2ef4bd.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:168)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 19:05:07 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 19:05:07 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 19:05:15 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578827114"}
2020-01-12 19:05:15 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 19:05:15 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"119d4d55d091caa45b16a6833e373529","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578827114"}
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjExOWQ0ZDU1ZDA5MWNhYTQ1YjE2YTY4MzNlMzczNTI5IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjcxMTQifQ==
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"119d4d55d091caa45b16a6833e373529","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578827114"}
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578827114"}
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:119d4d55d091caa45b16a6833e373529
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112190515137968
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112190515137968","order_price":15.00}
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=JhxGwc%2FRdhzzj7zmsvprVyDjfYi17dSswKdbfT7TSFYALCQD7F4e4OhfAIv6gU3u2kQLqbUS7FbazbR8izJ2frTDjEfAirCeDwI%2BpoBhrs0I5TLMGWAB7zkgaN%2Bk3WtQwFtiVtGMJPXHkxZ0MuJEPmHrZQULex%2FNH0UUlimTuTGZACL7%2Bf4RNrrzKHXiGeybL0TlRnrbAbdsF1sYdK4xTMdS5lAdzNEh7XEP4W1ojT3cxijf2EMq5ZK14troc7rMJQNyT8jZOv%2FC8PjjcFLN7iGSpu%2FC7Hd43j0za81JytlEVeZfhINlwtZgaHWlcxl1fueMjrlv3hLDCT1beQnuEQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+19%3A05%3A15&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112190515137968&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 19:05:15 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=JhxGwc%2FRdhzzj7zmsvprVyDjfYi17dSswKdbfT7TSFYALCQD7F4e4OhfAIv6gU3u2kQLqbUS7FbazbR8izJ2frTDjEfAirCeDwI%2BpoBhrs0I5TLMGWAB7zkgaN%2Bk3WtQwFtiVtGMJPXHkxZ0MuJEPmHrZQULex%2FNH0UUlimTuTGZACL7%2Bf4RNrrzKHXiGeybL0TlRnrbAbdsF1sYdK4xTMdS5lAdzNEh7XEP4W1ojT3cxijf2EMq5ZK14troc7rMJQNyT8jZOv%2FC8PjjcFLN7iGSpu%2FC7Hd43j0za81JytlEVeZfhINlwtZgaHWlcxl1fueMjrlv3hLDCT1beQnuEQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+19%3A05%3A15&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112190515137968&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 19:05:15 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$4ff57b5d.executeUpdateForSQL(<generated>)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$b9ca6a68.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$a80beae6.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:168)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 19:07:37 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 19:07:37 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 19:07:50 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578827270"}
2020-01-12 19:07:50 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 19:07:50 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"2e8950eef49fdafc05660113636696f7","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578827270"}
2020-01-12 19:07:50 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjJlODk1MGVlZjQ5ZmRhZmMwNTY2MDExMzYzNjY5NmY3IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MjcyNzAifQ==
2020-01-12 19:07:50 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"2e8950eef49fdafc05660113636696f7","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578827270"}
2020-01-12 19:07:50 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578827270"}
2020-01-12 19:07:50 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 19:07:50 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:2e8950eef49fdafc05660113636696f7
2020-01-12 19:07:51 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 19:07:51 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 19:07:51 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 19:07:51 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112190750788194
2020-01-12 19:07:51 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 19:07:51 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112190750788194","order_price":15.00}
2020-01-12 19:07:51 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=dnjUmV4xSrgALo3MGXbHOGvYZrPbPvxchys716%2FTi42PtpQf7K%2FgQWaGI3a3C2%2BNY2hA1ax0qXU5bIdvkg8um02vSk%2BeEvbZwNvRqtnUmoFOK%2FrqNSo7NnYbqbnopm6EQ154wa2q3LligXI%2FG%2Be%2B1dYSNN7iHPakcv%2FKELCz3tWXrbN6VBIASo7IiKfdIYqqo2P6o24T3ct8IXuJ8iaEzGUNpoHnd650tK7FfIcH84sVVMST%2FtPv2JAWlDGOpbrxo03sMnsLVFHBoclnX7zNF8EVilP9pxddhpdknfIQ8jtlG3OXS4NnWP3VfLFJxL2M%2FURV09LM0c%2BwmXHwkS4YzQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+19%3A07%3A51&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112190750788194&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 19:07:51 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=dnjUmV4xSrgALo3MGXbHOGvYZrPbPvxchys716%2FTi42PtpQf7K%2FgQWaGI3a3C2%2BNY2hA1ax0qXU5bIdvkg8um02vSk%2BeEvbZwNvRqtnUmoFOK%2FrqNSo7NnYbqbnopm6EQ154wa2q3LligXI%2FG%2Be%2B1dYSNN7iHPakcv%2FKELCz3tWXrbN6VBIASo7IiKfdIYqqo2P6o24T3ct8IXuJ8iaEzGUNpoHnd650tK7FfIcH84sVVMST%2FtPv2JAWlDGOpbrxo03sMnsLVFHBoclnX7zNF8EVilP9pxddhpdknfIQ8jtlG3OXS4NnWP3VfLFJxL2M%2FURV09LM0c%2BwmXHwkS4YzQ%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+19%3A07%3A51&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112190750788194&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 19:07:51 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$b729e423.executeUpdateForSQL(<generated>)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$b9ca6a68.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$f4053ac.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:168)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 20:51:46 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 20:51:46 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 20:51:59 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578833519"}
2020-01-12 20:51:59 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 20:51:59 [http-nio-8087-exec-2] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"660a4bef53154fb2a68c7cf118a038f8","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578833519"}
2020-01-12 20:51:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjY2MGE0YmVmNTMxNTRmYjJhNjhjN2NmMTE4YTAzOGY4IiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MzM1MTkifQ==
2020-01-12 20:51:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"660a4bef53154fb2a68c7cf118a038f8","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578833519"}
2020-01-12 20:51:59 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578833519"}
2020-01-12 20:51:59 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 20:51:59 [http-nio-8087-exec-3] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:660a4bef53154fb2a68c7cf118a038f8
2020-01-12 20:51:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 20:51:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 20:51:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 20:51:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112205159441371
2020-01-12 20:51:59 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 20:51:59 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112205159441371","order_price":15.00}
2020-01-12 20:52:00 [http-nio-8087-exec-3] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=fCXREYd4CAUbcVztlH%2FSC0zLXskZH84UwzcUs4avdgy10g7q9%2BqxjQp9chLmD8c0pVoz6tLhQKZlJkOppOXidpyyl5ChGVmS9BGo31%2Bk%2FihecsMVUK3FoCwD6KWtPtZADbGWYMJ%2BDguYYF4UF4eGb5YnXD6P4NbhamAJjPViCBnQX49skVZQPDdCtf37F87Jfkp%2BbWjIsrLiLMcS3Dd0Q8HohfRG0mPh5RHIPOeY6cI5v47UQLsqjt6gFEMF1fmEHsaIYdRvMcnUUvYGeh82n8vo6ag06EzIuX%2BOxMh3TuxOLVMbJfYBVrRtirI3HiOOvgckaiP7dLTTvtnrBL53Vw%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+20%3A51%3A59&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112205159441371&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 20:52:00 [http-nio-8087-exec-3] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=fCXREYd4CAUbcVztlH%2FSC0zLXskZH84UwzcUs4avdgy10g7q9%2BqxjQp9chLmD8c0pVoz6tLhQKZlJkOppOXidpyyl5ChGVmS9BGo31%2Bk%2FihecsMVUK3FoCwD6KWtPtZADbGWYMJ%2BDguYYF4UF4eGb5YnXD6P4NbhamAJjPViCBnQX49skVZQPDdCtf37F87Jfkp%2BbWjIsrLiLMcS3Dd0Q8HohfRG0mPh5RHIPOeY6cI5v47UQLsqjt6gFEMF1fmEHsaIYdRvMcnUUvYGeh82n8vo6ag06EzIuX%2BOxMh3TuxOLVMbJfYBVrRtirI3HiOOvgckaiP7dLTTvtnrBL53Vw%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+20%3A51%3A59&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112205159441371&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 20:52:00 [http-nio-8087-exec-3] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$6b44d7fd.executeUpdateForSQL(<generated>)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:52)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$b9ca6a68.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$c35b4786.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:168)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
2020-01-12 20:59:44 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 20:59:44 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 20:59:52 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578833992"}
2020-01-12 20:59:52 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 20:59:52 [http-nio-8087-exec-1] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"720cb7c18d92c6d01ac57a642552c033","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578833992"}
2020-01-12 20:59:52 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6IjcyMGNiN2MxOGQ5MmM2ZDAxYWM1N2E2NDI1NTJjMDMzIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MzM5OTIifQ==
2020-01-12 20:59:52 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"720cb7c18d92c6d01ac57a642552c033","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578833992"}
2020-01-12 20:59:52 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578833992"}
2020-01-12 20:59:52 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 20:59:52 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:720cb7c18d92c6d01ac57a642552c033
2020-01-12 20:59:52 [http-nio-8087-exec-2] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:255)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$6b91c394.getBySQLListMap(<generated>)
	at com.yufan.dao.db2.impl.OrderDaoImpl.queryOrderListMap(OrderDaoImpl.java:37)
	at com.yufan.dao.db2.impl.OrderDaoImpl$$FastClassBySpringCGLIB$$e6995858.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.db2.impl.OrderDaoImpl$$EnhancerBySpringCGLIB$$1a2132ed.queryOrderListMap(<generated>)
	at com.yufan.controller.PayController.payEnter(PayController.java:145)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:63)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:42)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2292)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2050)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2012)
	at org.hibernate.loader.Loader.doQuery(Loader.java:953)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:354)
	at org.hibernate.loader.Loader.doList(Loader.java:2815)
	at org.hibernate.loader.Loader.doList(Loader.java:2797)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2629)
	at org.hibernate.loader.Loader.list(Loader.java:2624)
	at org.hibernate.loader.custom.CustomLoader.list(CustomLoader.java:338)
	at org.hibernate.internal.SessionImpl.listCustomQuery(SessionImpl.java:2123)
	at org.hibernate.internal.AbstractSharedSessionContract.list(AbstractSharedSessionContract.java:1134)
	at org.hibernate.query.internal.NativeQueryImpl.doList(NativeQueryImpl.java:173)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1526)
	at org.hibernate.query.Query.getResultList(Query.java:165)
	at com.yufan.common.dao.GeneralDaoImpl.getBySQLListMap(GeneralDaoImpl.java:118)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 74 more
Caused by: java.sql.SQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '-db.tb_order o JOIN store-db.tb_order_detail d on o.order_id=d.order_id where o.' at line 1
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1003)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 96 more
2020-01-12 21:04:24 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 21:04:24 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 21:13:44 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clients:1
2020-01-12 21:13:44 [restartedMain] INFO  [com.yufan.cache.InitCache] - -----clientConfigs:1
2020-01-12 21:15:36 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578834936"}
2020-01-12 21:15:36 [http-nio-8087-exec-1] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 21:15:36 [http-nio-8087-exec-1] INFO  [com.yufan.controller.TestController] - ----请求支付参数-----{"order_no":"20191018193238251261","sign":"c19c2dcc5018133c839b6c9d0c66bb23","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578834936"}
2020-01-12 21:15:36 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str:eyJvcmRlcl9ubyI6IjIwMTkxMDE4MTkzMjM4MjUxMjYxIiwic2lnbiI6ImMxOWMyZGNjNTAxODEzM2M4MzliNmM5ZDBjNjZiYjIzIiwiYnVzaW5lc3NfY29kZSI6Im9yZGVyX3BheSIsInBheV93YXkiOjIsInJlY29yZF90eXBlIjo0LCJjbGllbnRfY29kZSI6Img1LXdlYiIsInRpbWVzdGFtcCI6IjE1Nzg4MzQ5MzYifQ==
2020-01-12 21:15:36 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ------------>base64Str明文:{"order_no":"20191018193238251261","sign":"c19c2dcc5018133c839b6c9d0c66bb23","business_code":"order_pay","pay_way":2,"record_type":4,"client_code":"h5-web","timestamp":"1578834936"}
2020-01-12 21:15:36 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------json:{"order_no":"20191018193238251261","business_code":"order_pay","record_type":4,"pay_way":2,"client_code":"h5-web","timestamp":"1578834936"}
2020-01-12 21:15:36 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------secretKey:dsfsdfsd
2020-01-12 21:15:36 [http-nio-8087-exec-2] INFO  [com.yufan.utils.VerifySign] - ---------clientSign:c19c2dcc5018133c839b6c9d0c66bb23
2020-01-12 21:15:36 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------orderNo:20191018193238251261
2020-01-12 21:15:36 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------goodsName:绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩
2020-01-12 21:15:36 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------orderPrice:15.00
2020-01-12 21:15:36 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - ---------partnerTradeNo:20200112211536820516
2020-01-12 21:15:36 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - -----调用支付宝支付接口-----
2020-01-12 21:15:36 [http-nio-8087-exec-2] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - -----调用支付宝支付接口参数-----param:{"goods_name":"绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩","quit_url":"http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault","partner_trade_no":"20200112211536820516","order_price":15.00}
2020-01-12 21:15:37 [http-nio-8087-exec-2] INFO  [com.yufan.utils.pay.alipay.AlipayUtils] - ------调用成功--------response:{"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=iAHDftREVO0JuywEwl2UwPabudgX6iTb5d3BqyAbt7NR9QOWBsOL1P6pGg%2FBgYqn%2Ff5Oy%2FrQKiIWjLvD7cNxTBeP99ST8ekgnw%2FNVi0WY7FhVA3EJlOGhAj9UOGHZU6%2FuklWzWLBOjBDTuZc%2FbaxFb7WIlN5I%2BQRccg0ECgVQzIVDQ6ST1t6nN1aoY9ibsnxjEFxxDbz8GhkZo5cQHLR12C2jQdKqpsZmYM35gONmdycQeQWZKgdGZsIcJ9YkYRh31aO1edjzrL%2FhJfZz6iAJ4Dy9JAR0nIu7BIx9GDZtFW79fkW5EU%2FJfC2zllf0VjDVfCHq5odFcDNCZr62ULrQw%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+21%3A15%3A37&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112211536820516&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","success":true}
2020-01-12 21:15:37 [http-nio-8087-exec-2] INFO  [com.yufan.controller.PayController] - --------{"msg":"","code":1,"body":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi.alipaydev.com/gateway.do?charset=UTF-8&method=alipay.trade.wap.pay&sign=iAHDftREVO0JuywEwl2UwPabudgX6iTb5d3BqyAbt7NR9QOWBsOL1P6pGg%2FBgYqn%2Ff5Oy%2FrQKiIWjLvD7cNxTBeP99ST8ekgnw%2FNVi0WY7FhVA3EJlOGhAj9UOGHZU6%2FuklWzWLBOjBDTuZc%2FbaxFb7WIlN5I%2BQRccg0ECgVQzIVDQ6ST1t6nN1aoY9ibsnxjEFxxDbz8GhkZo5cQHLR12C2jQdKqpsZmYM35gONmdycQeQWZKgdGZsIcJ9YkYRh31aO1edjzrL%2FhJfZz6iAJ4Dy9JAR0nIu7BIx9GDZtFW79fkW5EU%2FJfC2zllf0VjDVfCHq5odFcDNCZr62ULrQw%3D%3D&return_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fpay%2FalipayReturnPage&notify_url=http%3A%2F%2Flirf-shop.51vip.biz%3A25139%2Fpay-center%2Fnotice%2Falipay&version=1.0&app_id=2016092900624822&sign_type=RSA2&timestamp=2020-01-12+21%3A15%3A37&alipay_sdk=alipay-sdk-java-3.3.0&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;20200112211536820516&quot;,&quot;total_amount&quot;:&quot;15.00&quot;,&quot;quit_url&quot;:&quot;http://lirf-shop.51vip.biz:25139/pay-center/pay/interruptDefault&quot;,&quot;subject&quot;:&quot;绿萝盆栽室内净化空气吸除甲醛花卉吊兰办公室绿植物水培长藤绿箩&quot;,&quot;product_code&quot;:&quot;QUICK_WAP_WAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>"}
2020-01-12 21:15:37 [http-nio-8087-exec-2] ERROR [com.yufan.controller.PayController] - --异常---
org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:403)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:528)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:153)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.common.dao.GeneralDaoImpl$$EnhancerBySpringCGLIB$$6e2f4001.executeUpdateForSQL(<generated>)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl.updateTradeRecord(PayCenterDaoImpl.java:53)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl$$FastClassBySpringCGLIB$$b9ca6a68.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)
	at com.yufan.dao.db1.impl.PayCenterDaoImpl$$EnhancerBySpringCGLIB$$c645af8a.updateTradeRecord(<generated>)
	at com.yufan.service.impl.PayCenterServiceImpl.updateTradeRecord(PayCenterServiceImpl.java:42)
	at com.yufan.controller.PayController.payEnter(PayController.java:230)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:409)
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1601)
	at com.yufan.common.dao.GeneralDaoImpl.executeUpdateForSQL(GeneralDaoImpl.java:169)
	at com.yufan.common.dao.GeneralDaoImpl$$FastClassBySpringCGLIB$$fe365c85.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139)
	... 75 more
